"use strict";const inputSearch=document.querySelector(".js-input"),iconSearch=document.querySelector(".js-search"),title=document.querySelector(".js-title"),header=document.querySelector(".js-header"),asideFavorite=document.querySelector(".js-asideFavorite"),mainCards=document.querySelector(".js-content"),imgPlaceHolder="https://via.placeholder.com/260x310/ffffff/666666/?text=TVShows",removeMenu=document.querySelector(".js-removeMenu"),showMenuFavorite=document.querySelector(".js-showFavorite");let shows=[],favoritesShows=[];const listener=e=>{searchShow(),changeClassInitial()},changeClassInitial=()=>{header.classList.remove("headerInitial"),header.classList.add("header")},changeHeader=e=>{inputSearch.value="",mainCards.innerHTML="",header.classList.remove("header"),header.classList.add("headerInitial")},searchShow=()=>{inputSearch.value?conectApi():mainCards.innerHTML='<div class="contain__error"><h2 class="error">Â¡No has introducido ninguna serie!</h2><p class="text__error">No enfades al gatete y busca una serie para hacerle feliz</p><img class="gif__cat" src="https://media.giphy.com/media/c8NspwwVxwAiA/giphy.gif" alt="gif gatete"/></div>'},conectApi=()=>{const e=inputSearch.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{shows=e.map(e=>e.show),printShows(shows)})},printShows=e=>{mainCards.innerHTML="";for(const t of e){const e=favoritesShows.find(e=>e.id===t.id),s=void 0===e?"":"card__favoriteAdd",a=void 0===e?"":"colorTitle";null!==t.image?mainCards.innerHTML+=`<article id="${t.id}"class="card__show js-cards ${s}"><img class="card__show--img" title="${t.name}" src="${t.image.medium}" alt="${t.name}"/><div class="content__boxTitle"><h3 class="card__show--title ${a}">${t.name}</h3></div> </article>`:mainCards.innerHTML+=`<article id="${t.id}"class="card__show js-cards"><img class="card__show--img" title="${t.name}" src=${imgPlaceHolder} alt="${t.name}"/><div class="content__boxTitle"><h3 class="card__show--title ${a}">${t.name}</h3></div> </article>`}listenerCards()},printFavorites=()=>{const e=document.querySelector(".js-listFavorite");e.innerHTML="";for(const t of favoritesShows)null!==t.image?e.innerHTML+=`<li id="${t.id}"class="favorite__list--card"><img class="favorite__card__img" title="${t.name}" src="${t.image.medium}" alt="${t.name}"/><h4 class="favorite__title__list">${t.name}</h4><i class="far fa-times-circle js-buttonRemove" title="Eliminar serie de favoritos"></i>`:e.innerHTML+=`<li id="${t.id}"class="favorite__list--card"><img class="favorite__card__img" title="${t.name}" src="${imgPlaceHolder}" alt="${t.name}"/><h4 class="favorite__title__list">${t.name}</h4><i class="far fa-times-circle js-buttonRemove" title="Eliminar serie de favoritos"></i>`;listenersButtonFavorites(),printShows(shows)},listenerCards=()=>{const e=document.querySelectorAll(".js-cards");for(const t of e)t.addEventListener("click",handleFavorites)},handleFavorites=e=>{addFavorite(e),changeColorCard(e),printFavorites(),listenersButtonFavorites()},addFavorite=e=>{const t=e.currentTarget,s=parseInt(t.id),a=favoritesShows.find(e=>e.id===s),i=favoritesShows.findIndex(e=>e.id===s);if(void 0===a)for(const e of shows)s===e.id&&favoritesShows.push(e);else favoritesShows.splice(i,1);saveLocalStorage()},changeColorCard=e=>{const t=e.currentTarget,s=parseInt(t.id);void 0===favoritesShows.find(e=>e.id===s)?(t.classList.remove("card__favoriteAdd"),t.lastElementChild.firstChild.classList.remove("colorTitle")):(t.classList.add("card__favoriteAdd"),t.lastElementChild.firstChild.classList.add("colorTitle"),asideFavorite.classList.remove("hidden"),mainCards.classList.remove("content_cards"),mainCards.classList.add("content__cardsFavorite")),printFavoritesLS()},printFavoritesLS=()=>{favoritesShows.length>0?(asideFavorite.classList.remove("hidden"),mainCards.classList.remove("content_cards"),mainCards.classList.add("content__cardsFavorite")):(asideFavorite.classList.add("hidden"),mainCards.classList.add("content_cards"),mainCards.classList.remove("content__cardsFavorite")),printFavorites()},buttonRemoveAll=document.querySelector(".js-buttonRemoveAll"),removeAllFavorites=()=>{localStorage.removeItem("favorite"),asideFavorite.classList.add("hidden","menu"),mainCards.classList.add("content_cards"),mainCards.classList.remove("content__cardsFavorite"),favoritesShows=[]};buttonRemoveAll.addEventListener("click",removeAllFavorites);const removeFavorite=e=>{const t=e.currentTarget,s=parseInt(t.parentElement.id),a=favoritesShows.findIndex(e=>e.id===s);favoritesShows.splice(a,1),printFavorites(),saveLocalStorage(),printFavoritesLS()},listenersButtonFavorites=()=>{const e=document.querySelectorAll(".js-buttonRemove");for(const t of e)t.addEventListener("click",removeFavorite)},saveLocalStorage=()=>{localStorage.setItem("favorite",JSON.stringify(favoritesShows))},getFromLocalStorage=()=>{favoritesShows=JSON.parse(localStorage.getItem("favorite")),null===favoritesShows&&(favoritesShows=[]),printFavoritesLS()},removeMenuHidden=()=>{asideFavorite.classList.add("hidden"),showMenuFavorite.classList.remove("opacity")},showMenu=()=>{asideFavorite.classList.remove("hidden"),showMenuFavorite.classList.add("opacity")};iconSearch.addEventListener("click",listener),title.addEventListener("click",changeHeader),removeMenu.addEventListener("click",removeMenuHidden),showMenuFavorite.addEventListener("click",showMenu);const inputKey=e=>{13==event.keyCode&&listener()};inputSearch.addEventListener("keyup",inputKey),favoritesShows=JSON.parse(localStorage.getItem("favorite")),null===favoritesShows&&(favoritesShows=[]),printFavoritesLS(),listenersButtonFavorites();